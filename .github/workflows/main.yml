
name: Telegram Bot + RDP Server
on:
  workflow_dispatch:
jobs:
  telegram-bot-rdp:
    runs-on: windows-latest
    timeout-minutes: 3600
    steps:
      # ========================================
      # Ø§Ù„Ø®Ø·ÙˆØ© 1: Ø¥Ø¹Ø¯Ø§Ø¯ RDP Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ
      # ========================================
      - name: Configure Core RDP Settings
        run: |
          Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server' -Name "fDenyTSConnections" -Value 0 -Force
          Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp' -Name "UserAuthentication" -Value 0 -Force
          Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp' -Name "SecurityLayer" -Value 0 -Force
          netsh advfirewall firewall delete rule name="RDP-Tailscale"
          netsh advfirewall firewall add rule name="RDP-Tailscale" dir=in action=allow protocol=TCP localport=3389
          Restart-Service -Name TermService -Force

      - name: Create RDP User with Static Password
        run: |
          $password = "admin@123"
          $securePass = ConvertTo-SecureString $password -AsPlainText -Force

          if (-not (Get-LocalUser -Name "TOOLBOXLAP" -ErrorAction SilentlyContinue)) {
              New-LocalUser -Name "TOOLBOXLAP" -Password $securePass -AccountNeverExpires
          }

          Add-LocalGroupMember -Group "Administrators" -Member "TOOLBOXLAP"
          Add-LocalGroupMember -Group "Remote Desktop Users" -Member "TOOLBOXLAP"

          echo "RDP_CREDS=User: TOOLBOXLAP | Password: $password" >> $env:GITHUB_ENV

          if (-not (Get-LocalUser -Name "TOOLBOXLAP")) {
              Write-Error "User creation failed"
              exit 1
          }

      - name: Install Tailscale
        run: |
          $tsUrl = "https://pkgs.tailscale.com/stable/tailscale-setup-1.82.0-amd64.msi"
          $installerPath = "$env:TEMP\tailscale.msi"

          Invoke-WebRequest -Uri $tsUrl -OutFile $installerPath
          Start-Process msiexec.exe -ArgumentList "/i", "`"$installerPath`"", "/quiet", "/norestart" -Wait
          Remove-Item $installerPath -Force

      - name: Establish Tailscale Connection
        run: |
          & "$env:ProgramFiles\Tailscale\tailscale.exe" up --authkey=${{ secrets.TAILSCALE_AUTH_KEY }} --hostname=gh-runner-$env:GITHUB_RUN_ID
          $tsIP = $null
          $retries = 0
          while (-not $tsIP -and $retries -lt 10) {
              $tsIP = & "$env:ProgramFiles\Tailscale\tailscale.exe" ip -4
              Start-Sleep -Seconds 5
              $retries++
          }
          if (-not $tsIP) {
              Write-Error "Tailscale IP not assigned. Exiting."
              exit 1
          }
          echo "TAILSCALE_IP=$tsIP" >> $env:GITHUB_ENV

      - name: Verify RDP Accessibility
        run: |
          Write-Host "Tailscale IP: $env:TAILSCALE_IP"
          $testResult = Test-NetConnection -ComputerName $env:TAILSCALE_IP -Port 3389
          if (-not $testResult.TcpTestSucceeded) {
              Write-Error "TCP connection to RDP port 3389 failed"
              exit 1
          }
          Write-Host "TCP connectivity successful!"

      # ========================================
      # Ø§Ù„Ø®Ø·ÙˆØ© 2: Ø¥Ø¹Ø¯Ø§Ø¯ Python ÙˆÙ…ÙƒØªØ¨Ø§Øª Telegram
      # ========================================
      - name: Install Python and Required Packages
        run: |
          Write-Host "Installing Python packages for Telegram Bot..."
          
          # ØªØ«Ø¨ÙŠØª Python (Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù…Ø«Ø¨ØªØ§Ù‹)
          $pythonInstalled = Get-Command python -ErrorAction SilentlyContinue
          if (-not $pythonInstalled) {
              Write-Host "Python not found, installing via winget..."
              winget install --id Python.Python.3.11 -e --accept-package-agreements --accept-source-agreements
          }
          
          # ØªØ­Ø¯ÙŠØ« pip
          python -m pip install --upgrade pip
          
          # ØªØ«Ø¨ÙŠØª Ù…ÙƒØªØ¨Ø§Øª Telegram
          pip install python-telegram-bot==20.3
          pip install requests
          pip install asyncio
          
          Write-Host "Python packages installed successfully!"

      # ========================================
      # Ø§Ù„Ø®Ø·ÙˆØ© 3: Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ø¨ÙˆØª Telegram
      # ========================================
      - name: Create Telegram Bot Python Script
        run: |
          $botScript = @'
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
import os
import logging
import asyncio
from telegram import Update
from telegram.ext import Application, CommandHandler, MessageHandler, filters, ContextTypes

# ==================== Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¨ÙˆØª ====================
TELEGRAM_TOKEN = "7548278006:AAEGJlnZ4hqwAlmJrHnKQ4R6zunDlPkyAyo"

# ==================== Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ====================
logging.basicConfig(
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    level=logging.INFO,
    handlers=[
        logging.FileHandler('telegram_bot.log'),
        logging.StreamHandler()
    ]
)
logger = logging.getLogger(__name__)

# ==================== Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ====================
async def handle_message(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """Ù…Ø¹Ø§Ù„Ø¬Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ÙˆØ§Ø±Ø¯Ø©"""
    user = update.effective_user
    user_id = user.id
    user_name = user.first_name or "Ù…Ø³ØªØ®Ø¯Ù…"
    text = update.message.text
    
    logger.info(f"Ø±Ø³Ø§Ù„Ø© Ù…Ù† {user_name} (ID: {user_id}): {text}")
    
    # Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨ÙŠØ© Ø§Ù„Ø£ÙˆÙ„Ù‰ (ÙÙˆØ±ÙŠØ©)
    welcome1 = f"""
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘       ğŸŠ **Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ Ø¹Ø²ÙŠØ²ÙŠ!** ğŸŠ       â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ¨ **Ø£Ù‡Ù„Ø§Ù‹ ÙˆØ³Ù‡Ù„Ø§Ù‹ {user_name}** âœ¨

ğŸ†” **Ù…Ø¹Ø±ÙÙƒ:** `{user_id}`
ğŸ‘¤ **Ø§Ø³Ù…Ùƒ:** {user_name}
ğŸ“ **Ø±Ø³Ø§Ù„ØªÙƒ:** {text[:50] if text else "Ø¨Ø¯ÙˆÙ† Ù†Øµ"}

ğŸ† **Ø´ÙƒØ±Ø§Ù‹ Ù„ØªÙˆØ§ØµÙ„Ùƒ Ù…Ø¹Ù†Ø§!**
"""
    
    await update.message.reply_text(welcome1, parse_mode='Markdown')
    
    # Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨ÙŠØ© Ø§Ù„Ø«Ø§Ù†ÙŠØ© (ÙÙˆØ±ÙŠØ© Ø¨Ø¯ÙˆÙ† ØªØ£Ø®ÙŠØ±)
    welcome2 = """
ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘     ğŸš€ **Ø±Ø³Ø§Ù„Ø© ØªØ±Ø­ÙŠØ¨ Ø«Ø§Ù†ÙŠØ©!** ğŸš€      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯

ğŸ“Œ **Ù…Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø¨ÙˆØª:**
âœ… Ø±Ø¯ ÙÙˆØ±ÙŠ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„
âœ… ØªØ±Ø­ÙŠØ¨ Ù…Ø²Ø¯ÙˆØ¬ Ø¨Ø¯ÙˆÙ† ØªØ£Ø®ÙŠØ±
âœ… ØªØ´ØºÙŠÙ„ Ù…Ø³ØªÙ…Ø± 24/7
âœ… Ù…ØªÙƒØ§Ù…Ù„ Ù…Ø¹ Ø®Ø§Ø¯Ù… RDP

ğŸ”§ **Ø§Ù„Ø­Ø§Ù„Ø©:** Ø§Ù„Ø¨ÙˆØª ÙŠØ¹Ù…Ù„ Ø¨Ù†Ø¬Ø§Ø­!
ğŸ• **Ø§Ù„ÙˆÙ‚Øª:** Ø§Ù„Ø¢Ù†
ğŸ“Š **Ø§Ù„Ø­Ø§Ù„Ø©:** Ù†Ø´Ø· âœ…

ğŸ’¬ **ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø±Ø³Ø§Ù„ Ø£ÙŠ Ø±Ø³Ø§Ù„Ø© ÙˆØ³Ø£Ø±Ø¯ Ø¹Ù„ÙŠÙƒ ÙÙˆØ±Ø§Ù‹!**
"""
    
    await update.message.reply_text(welcome2, parse_mode='Markdown')

async def start_command(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """Ù…Ø¹Ø§Ù„Ø¬Ø© Ø£Ù…Ø± /start"""
    user = update.effective_user
    
    start_message = f"""
ğŸš€ **ØªÙ… Ø¨Ø¯Ø¡ Ø§Ù„Ø¨ÙˆØª Ø¨Ù†Ø¬Ø§Ø­!**

ğŸ‘‹ Ø£Ù‡Ù„Ø§Ù‹ {user.first_name}!
    
ğŸ“‹ **Ø§Ù„Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ù…ØªØ§Ø­Ø©:**
/start - Ø¨Ø¯Ø¡ Ø§Ù„Ø¨ÙˆØª
/help - Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©
Ø£ÙŠ Ø±Ø³Ø§Ù„Ø© - Ø³Ø£Ø±Ø¯ Ø¨ØªØ±Ø­ÙŠØ¨ Ù…Ø²Ø¯ÙˆØ¬!

âš¡ **Ø§Ù„Ø¨ÙˆØª ÙŠØ¹Ù…Ù„ Ø¹Ù„Ù‰ Ø®Ø§Ø¯Ù… GitHub Actions**
ğŸ–¥ï¸ **Ù…Ø¹ Ø®Ø§Ø¯Ù… RDP Ù†Ø´Ø·**
"""
    
    await update.message.reply_text(start_message, parse_mode='Markdown')

async def help_command(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """Ù…Ø¹Ø§Ù„Ø¬Ø© Ø£Ù…Ø± /help"""
    help_text = """
ğŸ†˜ **Ù…Ø³Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙˆØª:**

ğŸ“ **ÙƒÙŠÙÙŠØ© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:**
1. Ø£Ø±Ø³Ù„ Ø£ÙŠ Ø±Ø³Ø§Ù„Ø©
2. Ø³Ø£Ø±Ø¯ Ø¹Ù„ÙŠÙƒ Ø¨Ø±Ø³Ø§Ù„ØªÙŠÙ† ØªØ±Ø­ÙŠØ¨ÙŠØªÙŠÙ†
3. Ù„Ø§ Ø­Ø§Ø¬Ø© Ù„Ø£ÙˆØ§Ù…Ø± Ù…Ø¹Ù‚Ø¯Ø©

ğŸ”§ **Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª:**
- Ø±Ø¯ ÙÙˆØ±ÙŠ Ø¨Ø¯ÙˆÙ† ØªØ£Ø®ÙŠØ±
- ØªØ´ØºÙŠÙ„ Ù…Ø³ØªÙ…Ø± 24/7
- Ù…ØªÙƒØ§Ù…Ù„ Ù…Ø¹ RDP

ğŸ“ **Ù„Ø£ÙŠ Ø§Ø³ØªÙØ³Ø§Ø±:** Ø£Ø±Ø³Ù„ Ø±Ø³Ø§Ù„Ø© ÙˆØ³Ø£Ø±Ø¯ ÙÙˆØ±Ø§Ù‹!
"""
    
    await update.message.reply_text(help_text, parse_mode='Markdown')

async def error_handler(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡"""
    logger.error(f"Ø­Ø¯Ø« Ø®Ø·Ø£: {context.error}")
    if update and update.message:
        await update.message.reply_text("âš ï¸ Ø­Ø¯Ø« Ø®Ø·Ø£ØŒ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰...")

# ==================== Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ====================
def main():
    """Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨ÙˆØª"""
    logger.info("Ø¨Ø¯Ø¡ ØªØ´ØºÙŠÙ„ Ø¨ÙˆØª Telegram...")
    
    try:
        # Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        application = Application.builder().token(TELEGRAM_TOKEN).build()
        
        # Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø§Øª
        application.add_handler(CommandHandler("start", start_command))
        application.add_handler(CommandHandler("help", help_command))
        application.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, handle_message))
        
        # Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡
        application.add_error_handler(error_handler)
        
        logger.info("Ø§Ù„Ø¨ÙˆØª Ø¬Ø§Ù‡Ø² Ù„Ù„Ø§Ø³ØªÙ‚Ø¨Ø§Ù„...")
        
        # Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹ Ù„Ù„Ø±Ø³Ø§Ø¦Ù„
        application.run_polling(allowed_updates=Update.ALL_TYPES)
        
    except Exception as e:
        logger.error(f"Ø®Ø·Ø£ ÙÙŠ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨ÙˆØª: {e}")
        raise

# ==================== Ù†Ù‚Ø·Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ ====================
if __name__ == "__main__":
    main()
'@
          
          # Ø­ÙØ¸ Ù…Ù„Ù Ø§Ù„Ø¨ÙˆØª
          $botScript | Out-File -FilePath "telegram_bot.py" -Encoding UTF8
          Write-Host "âœ… Telegram bot script created successfully!"
          
          # Ø¹Ø±Ø¶ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ù„Ù Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©
          Get-Content "telegram_bot.py" -First 10

      # ========================================
      # Ø§Ù„Ø®Ø·ÙˆØ© 4: ØªØ´ØºÙŠÙ„ Ø¨ÙˆØª Telegram ÙÙŠ Ø§Ù„Ø®Ù„ÙÙŠØ©
      # ========================================
      - name: Start Telegram Bot in Background
        run: |
          Write-Host "Starting Telegram Bot..."
          
          # Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ø¨Ø§ØªØ´ Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨ÙˆØª ÙÙŠ Ø§Ù„Ø®Ù„ÙÙŠØ©
          $batchScript = @'
@echo off
echo ========================================
echo    ØªØ´ØºÙŠÙ„ Ø¨ÙˆØª Telegram Ø¹Ù„Ù‰ GitHub Actions
echo ========================================
echo.
echo [%date% %time%] Ø¨Ø¯Ø¡ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨ÙˆØª...
python telegram_bot.py
if errorlevel 1 (
    echo [%date% %time%] Ø®Ø·Ø£ ÙÙŠ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨ÙˆØªØŒ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©...
    timeout /t 5 /nobreak
    python telegram_bot.py
)
'@
          
          $batchScript | Out-File -FilePath "start_bot.bat" -Encoding ASCII
          
          # ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨ÙˆØª ÙÙŠ Ù†Ø§ÙØ°Ø© Ø¬Ø¯ÙŠØ¯Ø© (Ø®Ù„ÙÙŠØ©)
          Start-Process cmd.exe -ArgumentList "/c start_bot.bat" -WindowStyle Hidden
          
          # Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ù‚Ù„ÙŠÙ„Ø§Ù‹ Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¨Ø¯Ø¡ Ø§Ù„ØªØ´ØºÙŠÙ„
          Start-Sleep -Seconds 10
          
          # Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨ÙˆØª
          $botProcess = Get-Process python -ErrorAction SilentlyContinue
          if ($botProcess) {
              Write-Host "âœ… Telegram Bot is running! (PID: $($botProcess.Id))"
          } else {
              Write-Host "âš ï¸ Bot process not found, trying alternative method..."
              # Ù…Ø­Ø§ÙˆÙ„Ø© Ø¨Ø¯ÙŠÙ„Ø©
              Start-Process python -ArgumentList "telegram_bot.py" -WindowStyle Hidden
              Start-Sleep -Seconds 5
          }

      # ========================================
      # Ø§Ù„Ø®Ø·ÙˆØ© 5: Ø¹Ø±Ø¶ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ ÙˆØ§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„ØªØ´ØºÙŠÙ„
      # ========================================
      - name: Maintain Both Services Running
        run: |
          Write-Host "`n"
          Write-Host "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
          Write-Host "â•‘      âœ… Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø®Ø¯Ù…Ø§Øª ØªØ¹Ù…Ù„ Ø¨Ù†Ø¬Ø§Ø­! âœ…                  â•‘"
          Write-Host "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          Write-Host "`n"
          
          Write-Host "=================== RDP ACCESS ==================="
          Write-Host "Address: $env:TAILSCALE_IP"
          Write-Host "Username: TOOLBOXLAP"
          Write-Host "Password: admin@123"
          Write-Host "`n"
          
          Write-Host "================ TELEGRAM BOT ===================="
          Write-Host "Bot Token: 7548278006:AAEGJlnZ4hqwAlmJrHnKQ4R6zunDlPkyAyo"
          Write-Host "Status: Running in background"
          Write-Host "Features: Instant reply with double welcome messages"
          Write-Host "`n"
          
          Write-Host "============== SYSTEM INFORMATION ==============="
          Write-Host "Host: GitHub Actions Windows Runner"
          Write-Host "Services: RDP Server + Telegram Bot"
          Write-Host "Uptime: Will run for 60 hours (3600 minutes)"
          Write-Host "`n"
          
          Write-Host "ğŸ“Œ Ù„Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ RDP: Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø£Ø¹Ù„Ø§Ù‡"
          Write-Host "ğŸ¤– Ù„Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¨ÙˆØª: Ø£Ø±Ø³Ù„ Ø£ÙŠ Ø±Ø³Ø§Ù„Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø¨ÙˆØª"
          Write-Host "`n"
          
          # Ø¹Ø¯Ø§Ø¯ Ø§Ù„ÙˆÙ‚Øª ÙˆØ§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„ØªØ´ØºÙŠÙ„
          $minutes = 0
          while ($true) {
              $minutes++
              $currentTime = Get-Date -Format "yyyy-MM-dd HH:mm:ss"
              
              if ($minutes % 30 -eq 0) {
                  Write-Host "`n"
                  Write-Host "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
                  Write-Host "[$currentTime] Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠØ¹Ù…Ù„ - $minutes Ø¯Ù‚ÙŠÙ‚Ø©"
                  Write-Host "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
                  
                  # Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø§Ù„Ø© Ø§Ù„Ø¨ÙˆØª
                  $botProcess = Get-Process python -ErrorAction SilentlyContinue
                  if ($botProcess) {
                      Write-Host "Telegram Bot: âœ… Ù†Ø´Ø· (PID: $($botProcess.Id))"
                  } else {
                      Write-Host "Telegram Bot: âŒ Ù…ØªÙˆÙ‚ÙØŒ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ´ØºÙŠÙ„..."
                      Start-Process python -ArgumentList "telegram_bot.py" -WindowStyle Hidden
                  }
                  
                  # Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø§Ù„Ø© RDP
                  $rdpService = Get-Service TermService
                  Write-Host "RDP Service: $($rdpService.Status)"
              }
              
              Write-Host "[$currentTime] Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø®Ø¯Ù…Ø§Øª ØªØ¹Ù…Ù„ - Ø§Ø¶ØºØ· Ctrl+C ÙÙŠ GitHub Ù„Ø¥ÙŠÙ‚Ø§Ù"
              Start-Sleep -Seconds 60
          }

      # ========================================
      # Ø§Ù„Ø®Ø·ÙˆØ© 6: Ø§Ù„ØªÙ†Ø¸ÙŠÙ Ø¹Ù†Ø¯ Ø§Ù„Ø¥ÙŠÙ‚Ø§Ù (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
      # ========================================
      - name: Cleanup on Stop
        if: always()
        run: |
          Write-Host "Ø¬Ø§Ø±ÙŠ Ø¥ÙŠÙ‚Ø§Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø®Ø¯Ù…Ø§Øª..."
          
          # Ø¥ÙŠÙ‚Ø§Ù Ø¨ÙˆØª Telegram
          Get-Process python -ErrorAction SilentlyContinue | Stop-Process -Force
          
          # Ø¥ÙŠÙ‚Ø§Ù Tailscale
          Get-Process tailscale -ErrorAction SilentlyContinue | Stop-Process -Force
          
          Write-Host "âœ… ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø¨Ù†Ø¬Ø§Ø­"
